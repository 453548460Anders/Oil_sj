<template>
  <div class="page" data-name="catalog">
    <div class="navbar">
      <div class="navbar-inner sliding">
        <div class="left">
          <a href="#" class="link back">
            <i class="icon icon-back color-blue"></i>
          </a>
        </div>
        <div class="title">预览</div>
        <div class="right" style="width: 66px"></div>
      </div>
    </div>
    <div class="page-content hide-navbar-on-scroll">
      <div class="list inline-labels no-hairlines-md">
        <ul>
          <li class="item-content item-input">
            <div class="item-inner">
              <div class="item-title item-label">铅封号</div>
              <div class="item-input-wrap">
                <input id="entity-id" type="text" placeholder="请输入">
                <span class="input-clear-button"></span>
              </div>
            </div>
          </li>
          <li class="item-content item-input order-upload-container">
            <div class="item-inner ">
              <div class="item-title item-label" style="width: 200px">铅封图片</div>
              <div id="reupload">
                <button class="col button button-fill order-upload-btn">上传</button>
              </div>
            </div>
            <div class="order-upload-image">
              <img id="order-entity-image" src="./images/default_order.png" style="max-width: 100%;max-height: 100%" />
            </div>
          </li>
        </ul>
      </div>
    </div>
  </div>
</template>
<script>
  return {
    on: {
      pageMounted: function (e, page) {
        var me = this;
        console.error('上传磅单', this);
        mui.back = function () {
          me.$router.back();
          setTimeout(function () {
            $$(document).trigger('hallReady');
            $$(document).trigger('orderReady');
          }, 500);
        }
        me.$$('.toolbar').addClass('hidden');
        me.$('.back').on('click', function (event) {
          event.stopPropagation();
          event.preventDefault();
          me.$app.router.back();
        });
        me.$('#reupload').css('display', 'none');
        me.$('#entity-id').attr('readonly', 'readonly');
        me.$('#entity-id')[0].value = me.number;
        me.$('#order-entity-image').attr('src', window.imageUrl + me.fannex);

        var src = window.imageUrl + me.fannex;

        var dynamicPopup = app.popup.create({
          content: '<div class="popup">' +
            '<div class="block" style="margin: 0!important;padding: 10px!important">' +
            '<img id="order-entity-image" src="' + src + '" style="max-width: 100%;max-height: 100%" />' +
            '</div>' +
            '<div id="closeId" style="position: absolute;top: 0;right: 0;z-index: 99999;background: #fff;width: 32px;height: 32px;border-radius: 32px;"><i style="font-size: 32px;color: #A39F9F;position: absolute;top: 50%;left: 50%;-webkit-transform: translate(-50%, -50%);" class="iconfont icon-close"></i></div>' +
            '</div>',
        });
        me.$('.order-upload-image').on('click', function () {
          dynamicPopup.open();
          me.$('#closeId').on('click', function () {
            dynamicPopup.close();
          });
        });
      }
    },
  };
</script>